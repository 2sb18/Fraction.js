/*
 Fraction.js v1.0.0 12/03/2014
 http://www.xarg.org/2014/03/precise-calculations-in-javascript/

 Copyright (c) 2014, Robert Eisele (robert@xarg.org)
 Dual licensed under the MIT or GPL Version 2 licenses.
*/
function Fraction(k){function m(a,b){if(0===b%2)return m(a,b/2);if(0===b%5)return m(a,b/5);for(var c=1;c<=b;c++)if(1===n(c,b))return c;return 0}function n(a,b){for(var c=10,d=1;0<a;c=c*c%b,a>>=1)a&1&&(d=d*c%b);return d}function e(a,b){if(!b)throw"DIV/0";this.s=(0<a)-(0>a);a=Math.abs(a);b=Math.abs(b);for(var c=a,d=b,e;d;)e=d,d=c%d,c=e;this.n=a/c;this.d=b/c;return this}function h(a){var b,c,d=1;switch(typeof a){case "object":if(void 0!==a[0]&&void 0!==a[1]){b=a[0];c=a[1];d=b*c;break}else if("d"in a&&"n"in
a){b=a.n;c=a.d;d=b*c;void 0!==a.s&&(d*=a.s);break}else if("z"in a&&"n"in a){b=a.z;c=a.n;d=b*c;break}else throw"Unknown format";case "string":a=a.replace(/^[\s]+/g,"").replace(/[\s]+$/,"").replace(",","");case "number":b=(""+a).split("");a=[0,0,0,0,0];c=[0,0,0,0,0];for(var h,f=0,g=0;g<b.length;g++)if("."===b[g])if(0===f)f++;else throw"Corrupted number";else if("("===b[g]||"'"===b[g]||")"===b[g])if(0<f&&3>f)f++;else throw"Corrupted number";else if(0===g&&"-"===b[0])d=-1;else if(3>f){h=parseInt(b[g],
10);if(isNaN(h))throw"Corrupted number";a[f]=10*a[f]+h;c[f]++}else throw"Corrupted number";if(2===f)throw"Corrupted number";a[3]=Math.pow(10,c[1]);a[4]=0<a[2]?Math.pow(10,c[2])-1:1;b=a[2]+a[4]*(a[0]*a[3]+a[1]);c=a[3]*a[4];break;default:throw"Unknown type";}c||e(0,0);l.n=Math.abs(b);l.d=Math.abs(c);l.s=(0<d)-(0>d);return l}this.abs=function(){return e.call(this,this.n,this.d)};this.add=function(a){a=h(a);return e.call(this,this.s*this.n*a.d+a.s*this.d*a.n,this.d*a.d)};this.sub=function(a){a=h(a);return e.call(this,
this.s*this.n*a.d-a.s*this.d*a.n,this.d*a.d)};this.mul=function(a){a=h(a);return e.call(this,this.s*a.s*this.n*a.n,this.d*a.d)};this.div=function(a){a=h(a);return e.call(this,this.s*a.s*this.n*a.d,this.d*a.n)};this.set=function(a){a=h(a);return e.call(this,a.s*a.n,a.d)};this.mod=function(a){a=h(a);return 0===a.n*this.d?e.call(this,0,0):e.call(this,this.s*a.d*this.n%(a.n*this.d),a.d*this.d)};this.reciprocal=function(){return e.call(this,this.s*this.d,this.n)};this.equals=function(a){a=h(a);return a.s*
a.n*this.d===this.s*this.n*a.d};this.divisible=function(a){a=h(a);return 0===this.n*a.d%(a.n*this.d)};this.sqrt=function(){if(0>this.s)throw"No complex root";var a=Math.sqrt(this.n/this.d),b={n:a|0,d:1},c={n:this.n,d:this.d},d=1E-4+a;if(1E4*a===Math.floor(1E4*a))return e.call(this,1E4*a,1E4);do this.set(c).div(b).add(b).div(2),b.n=this.n,b.d=this.d;while(b.n/b.d>d);return e.call(this,b.n,b.d)};this.toString=function(){var a=(""+this.n).split(""),b=this.d,c=0,d="",e=m(this.n,this.d),f;a:{f=this.d;
for(var g=0;g<f;g++)if(n(g,f)===n(g+e,f)){f=g;break a}f=0}for(var g=-1,h=10+e+f+a.length,k=0;k<h;k++){c*=10;k<a.length?c+=parseInt(a[k],10):k===a.length?(d+=".",g=0):g++;if(0<e&&g===f)d+="(";else if(0<e&&g-f===e){d+=")";break}c>=b?(d+=c/b|0,c%=b):d+="0"}return(~this.s?"":"-")+d.replace(/^0+([1-9]|0\.)/g,"$1").replace(/(\d)0+$/,"$1")};this.n=this.s=0;this.d=1;var l={n:0,d:0,s:0};k=h(k);e.call(this,k.s*k.n,k.d)}module&&module.exports&&(module.exports.Fraction=Fraction);
